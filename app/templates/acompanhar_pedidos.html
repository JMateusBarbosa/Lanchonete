{% extends "layouts/base.html" %}

{% block title %}Acompanhar Pedidos{% endblock %}

{% block additional_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/acompanhar_pedidos.css') }}">
{% endblock %}

{% block content %}
<h1 class="page-title">Acompanhar Pedidos</h1>

<!-- Barra de Ferramentas Superior -->
<div class="toolbar">
    <div class="search-bar">
        <input type="text" id="search" placeholder="Buscar por pedido, mesa ou cliente...">
    </div>
    <div class="filters">
        <select id="filter-status">
            <option value="all">Todos</option>
            <option value="pending">Pendentes</option>
            <option value="completed">Concluídos</option>
        </select>
        <select id="filter-time">
            <option value="all">Todos os tempos</option>
            <option value="30m">Últimos 30 minutos</option>
            <option value="1h">Última hora</option>
            <option value="today">Hoje</option>
        </select>
    </div>
    <div class="update-controls">
        <button id="refresh-button">Atualizar</button>
        <div class="auto-refresh">
            <input type="checkbox" id="auto-refresh" checked>
            <label for="auto-refresh">Atualização automática</label>
        </div>
    </div>
</div>

<!-- Tabela de Pedidos -->
    {% block pedidos_table %}
    <table class="orders-table">
        <thead>
            <tr>
                <th>ID do Pedido</th>
                <th>Hora</th>
                <th>Mesa/Cliente</th>
                <th>Itens</th>
                <th>Status</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for pedido in pedidos %}
            <tr class="order-row" data-pedido-id="{{ pedido.id }}" data-status="{{ pedido.status }}">
                <td>{{ pedido.id }}</td>
                <td>{{ pedido.data_pedido.strftime('%H:%M') }}</td>
                <td>{{ pedido.mesa_cliente }}</td>
                <td>
                    {% for item in pedido.itens %}
                        {{ item.quantidade }}x {{ item.nome }}
                    {% endfor %}
                </td>
                <td class="status-cell">
                    <span class="status {{ pedido.status | lower }}">{{ pedido.status }}</span>
                    <button class="status-toggle" data-novo-status="{% if pedido.status == 'Pendente' %}Concluído{% else %}Pendente{% endif %}">
                        {% if pedido.status == 'Pendente' %}Concluir{% else %}Reabrir{% endif %}
                    </button>
                </td>
                <td class="actions-cell">
                    <button class="expand-details">Ver Detalhes</button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endblock %}


<!-- Notificações em Tempo Real -->
<div id="notifications"></div>

{% endblock %}
